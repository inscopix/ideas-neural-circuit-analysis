{
    "key": "population_activity",
    "name": "Compare Neural Activity Across States",
    "version": "6.0.3",
    "description": "Measure population activity during two states",
    "schema_version": "3.0.0",
    "container_image": {
        "repository": "platform/neuro-stats",
        "label": "0.0.4"
    },
    "command": {
        "file_path": "analysis/population_activity.py",
        "entry_point": "population_activity_ideas_wrapper",
        "program_type": "PYTHON"
    },
    "params": [
        {
            "key": "cell_set_files",
            "name": "Cell Set File(s)",
            "required": true,
            "description": "ISXD cell set file(s)",
            "type": {
                "param_type": "ToolPathParam",
                "multiple": true,
                "file_formats": [
                    "isxd"
                ]
            },
            "group": "Input Files"
        },
        {
            "key": "event_set_files",
            "name": "Event Set File(s)",
            "required": false,
            "description": "ISXD event set file(s)",
            "type": {
                "param_type": "ToolPathParam",
                "multiple": true,
                "file_formats": [
                    "isxd"
                ]
            },
            "group": "Input Files"
        },
        {
            "key": "annotations_file",
            "name": "Annotations File",
            "required": true,
            "description": "Experiment Annotations file",
            "type": {
                "param_type": "ToolPathParam",
                "multiple": true,
                "file_formats": [
                    "parquet"
                ]
            },
            "group": "Input Files"
        },
        {
            "key": "concatenate",
            "name": "Concatenate Files End-to-End",
            "required": true,
            "description": "Whether to concatenate the cell set files end-to-end, or space them according to their original timestamps",
            "type": {
                "param_type": "ToolBooleanParam",
                "default": true
            },
            "group": "Data Pre-processing"
        },
        {
            "key": "trace_scale_method",
            "name": "Method to Rescale Trace Activity Data",
            "required": false,
            "description": "The trace activity data will be rescaled using the specified method. If 'none' is selected, the original raw calcium trace values will be used without any transformation, preserving the original scale of the measurements.",
            "type": {
                "param_type": "ToolChoiceParam",
                "default": "none",
                "choices": [
                    "none",
                    "standardize",
                    "normalize",
                    "standardize_baseline",
                    "fractional_change"
                ],
                "display_options": [
                    "None",
                    "Standardize",
                    "Normalize",
                    "Standardize to baseline",
                    "Fractional change from baseline"
                ]
            },
            "group": "Data Pre-processing"
        },
        {
            "key": "event_scale_method",
            "name": "Method to Rescale Event Rate Data",
            "required": false,
            "description": "If specified, the event rate data will be rescaled using the specified method",
            "type": {
                "param_type": "ToolChoiceParam",
                "default": "none",
                "choices": [
                    "none",
                    "standardize",
                    "normalize",
                    "standardize_baseline",
                    "fractional_change"
                ],
                "display_options": [
                    "None",
                    "Standardize",
                    "Normalize",
                    "Standardize to baseline",
                    "Fractional change from baseline"
                ]
            },
            "group": "Data Pre-processing"
        },
        {
            "key": "column_name",
            "name": "Column Name",
            "required": true,
            "description": "Column name in annotations file with states",
            "type": {
                "param_type": "ToolStringParam",
                "default": "state"
            },
            "group": "States"
        },
        {
            "key": "state_names",
            "name": "State Names",
            "required": true,
            "description": "Names of states to compare.",
            "type": {
                "param_type": "ToolStringParam"
            },
            "group": "States"
        },
        {
            "key": "state_colors",
            "name": "State Colors",
            "required": true,
            "description": "List of matplotlib compatible colors to represent each state",
            "type": {
                "param_type": "ToolStringParam"
            },
            "group": "States"
        },
        {
            "key": "method",
            "name": "Method to compare states",
            "required": true,
            "description": "The method to compare states against each other",
            "type": {
                "param_type": "ToolChoiceParam",
                "default": "state vs not state",
                "choices": [
                    "pairwise",
                    "state vs baseline",
                    "state vs not defined",
                    "state vs not state"
                ],
                "display_options": [
                    "Pairwise",
                    "State vs Baseline",
                    "State vs Not Defined",
                    "State vs Not State"
                ]
            },
            "group": "States"
        },
        {
            "key": "baseline_state",
            "name": "Baseline State",
            "required": false,
            "description": "Optional parameter to define the baseline state for comparison if method is state vs baseline, or for rescaling if method is standardize to baseline or fractional change",
            "type": {
                "param_type": "ToolStringParam"
            },
            "group": "States"
        },
        {
            "key": "modulation_colors",
            "name": "Modulation Colors",
            "required": true,
            "description": "Colors to represent up and down modulation respectively",
            "type": {
                "param_type": "ToolStringParam",
                "default": "tab:red, tab:blue"
            },
            "group": "Modulation Parameters"
        },
        {
            "key": "n_shuffle",
            "name": "Number of Shuffles",
            "required": false,
            "description": "Number of shuffles to determine if a neuron is significantly modulated by state",
            "type": {
                "param_type": "ToolIntRangeParam",
                "default": 1000,
                "min": 10,
                "max": 100000
            },
            "group": "Modulation Parameters"
        },
        {
            "key": "alpha",
            "name": "Significance Threshold",
            "required": false,
            "description": "Significance threshold (alpha) below which p-values are considered significant.",
            "type": {
                "param_type": "ToolFloatRangeParam",
                "default": 0.05,
                "min": 0,
                "max": 1.0
            },
            "group": "Modulation Parameters"
        }
    ],
    "results": [
        {
            "key": "trace_population_data",
            "name": "Trace-based Analysis",
            "description": "A CSV file containing average activity and associated modulation score data for each cell in each comparison of states",
            "file_patterns": [
                "trace_population_data/**/*"
            ]
        },
        {
            "key": "event_population_data",
            "name": "Event-based Analysis",
            "description": "A CSV file containing event rate and associated modulation score data for each cell in each comparison of states",
            "file_patterns": [
                "event_population_data/**/*"
            ]
        }
    ],
    "resources": {
        "cpu": 1,
        "gpu": 0,
        "memory": 10000
    },
    "visibility": "public"
}
