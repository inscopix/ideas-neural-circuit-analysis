{
    "key": "correlations",
    "name": "Compare Neural Circuit Correlations Across States",
    "version": "8.0.3",
    "schema_version": "3.0.0",
    "description": "Calculate pairwise correlations between cell traces, and estimates how correlations change between two states of interest",
    "container_image": {
        "repository": "platform/neuro-stats",
        "label": "0.0.3"
    },
    "command": {
        "file_path": "analysis/correlations.py",
        "entry_point": "correlation_tool_ideas_wrapper",
        "program_type": "PYTHON"
    },
    "params": [
        {
            "key": "cell_set_files",
            "name": "Cell Set Files",
            "required": true,
            "description": "ISXD cell set file(s)",
            "type": {
                "param_type": "ToolPathParam",
                "multiple": true,
                "file_formats": [
                    "isxd"
                ]
            },
            "group": "Input Files"
        },
        {
            "key": "annotations_file",
            "name": "Annotations File",
            "required": false,
            "description": "File containing annotations about states, synchronised to ISXD cell set file",
            "type": {
                "param_type": "ToolPathParam",
                "multiple": true,
                "file_formats": [
                    "parquet"
                ]
            },
            "group": "Input Files"
        },
        {
            "key": "column_name",
            "name": "Column Name",
            "required": true,
            "description": "Column name in annotations file that identifies state",
            "type": {
                "param_type": "ToolStringParam",
                "default": "state"
            },
            "group": "Parameters"
        },
        {
            "key": "state_names",
            "name": "State Names",
            "required": false,
            "description": "Specify which behavioral states to analyze (comma-separated list). For single state analysis, correlations from that state will be compared with all other time periods. For multiple states, correlations will be compared between the specified states.",
            "type": {
                "param_type": "ToolStringParam",
                "default": ""
            },
            "group": "States"
        },
        {
            "key": "state_colors",
            "name": "State Colors",
            "required": false,
            "description": "List of matplotlib compatible colors to represent each state",
            "type": {
                "param_type": "ToolStringParam",
                "default": "blue, orange, grey"
            },
            "group": "States"
        },
        {
            "key": "correlation_colors",
            "name": "Correlation Colors",
            "required": true,
            "description": "List of colors to use for positive and negative correlations, or a colormap",
            "type": {
                "param_type": "ToolStringParam",
                "default": "tab:red, tab:blue"
            },
            "group": "States"
        },
        {
            "key": "statistic",
            "name": "Statistic",
            "required": true,
            "description": "Statistic of correlation to compare (max, mean or min)",
            "type": {
                "param_type": "ToolChoiceParam",
                "default": "max",
                "choices": [
                    "mean",
                    "max",
                    "min"
                ],
                "display_options": [
                    "mean",
                    "max",
                    "min"
                ]
            },
            "group": "Parameters"
        },
        {
            "key": "include_positions",
            "name": "include_positions",
            "required": false,
            "description": "include_positions",
            "type": {
                "param_type": "ToolBooleanParam",
                "default": true
            },
            "group": "Parameters"
        },
        {
            "key": "correlation_threshold",
            "name": "Correlation Threshold for Spatial Map",
            "required": false,
            "description": "Minimum absolute correlation value to display in the spatial correlation map. Only cell pairs with correlations above this threshold will be shown as connections.",
            "type": {
                "param_type": "ToolFloatRangeParam",
                "default": 0.5,
                "min": 0.0,
                "max": 1.0
            },
            "group": "Parameters"
        }
    ],
    "results": [
        {
            "key": "average_correlations",
            "name": "Average Correlations",
            "description": "The average positive correlation and average negative correlation in each state",
            "file_patterns": [
                "average_correlations/**/*"
            ]
        },
        {
            "key": "pairwise_correlation_heatmaps",
            "name": "Pairwise Correlation Heatmaps",
            "description": "Raw correlation matrices",
            "file_patterns": [
                "pairwise_correlation_heatmaps/**/*"
            ]
        },
        {
            "key": "spatial_analysis_pairwise_correlations",
            "name": "Spatial Analysis of Pairwise Correlations",
            "description": "Raw correlation matrices and cell pair correlations, with spatial position information for each cell pair",
            "file_patterns": [
                "spatial_analysis_pairwise_correlations/**/*"
            ]
        },
        {
            "key": "correlation_statistic_comparison",
            "name": "Correlation Statistic Comparison",
            "description": "Max/mean/min correlations by neuron",
            "file_patterns": [
                "correlation_statistic_comparison/**/*"
            ]
        }
    ],
    "resources": {
        "cpu": 1,
        "gpu": 0,
        "memory": 10000
    },
    "visibility": "public",
    "docs_link": "https://inscopix.github.io/ideas-docs/tools/epochs/correlations__correlation_tool/correlations__correlation_tool.html",
    "code_link": "https://github.com/inscopix/ideas-neural-circuit-analysis"
}
