{
    "key": "peri_event_workflow",
    "name": "Peri-Event Analysis Workflow",
    "version": "7.0.0",
    "description": "Analyze neural activity around (peri) the time of each event, specifically testing for up- or down-modulation of both average population and single cells by comparing activity before (pre) and after (post) each event.",
    "schema_version": "3.0.0",
    "container_image": {
        "repository": "platform/neuro-stats",
        "label": "0.0.1"
    },
    "command": {
        "file_path": "analysis/peri_event_workflow.py",
        "entry_point": "run_peri_event_workflow",
        "program_type": "PYTHON"
    },
    "params": [
        {
            "key": "input_cellset_files",
            "name": "Input cell sets",
            "required": true,
            "description": "Select cell sets to use for analysis",
            "type": {
                "param_type": "ToolPathParam",
                "multiple": true,
                "file_formats": [
                    "isxd"
                ]
            },
            "group": "Input Files"
        },
        {
            "key": "input_events_h5_file",
            "name": "Input events",
            "required": true,
            "description": "Select event data to use for analysis",
            "type": {
                "param_type": "ToolPathParam",
                "multiple": false,
                "file_formats": [
                    "h5"
                ]
            },
            "group": "Input Files"
        },
        {
            "key": "event_type",
            "name": "Event type",
            "required": true,
            "description": "Select type of event to analyze from the column names of the event file",
            "type": {
                "param_type": "ToolStringParam"
            }
        },
        {
            "key": "visual_window_pre",
            "name": "Visual window (pre)",
            "required": true,
            "description": "Time in seconds to visualize before each event in output figures (not used for statistics)",
            "type": {
                "param_type": "ToolFloatRangeParam",
                "default": -2,
                "max": 0
            },
            "group": "Visualization Parameters"
        },
        {
            "key": "visual_window_post",
            "name": "Visual window (post)",
            "required": true,
            "description": "Time in seconds to visualize after each event in output graphs (not used for statistics)",
            "type": {
                "param_type": "ToolFloatRangeParam",
                "default": 2,
                "min": 0
            },
            "group": "Visualization Parameters"
        },
        {
            "key": "statistical_window_pre_start",
            "name": "Statistical window (pre, start)",
            "required": true,
            "description": "Start of time window in seconds before each event to use for statistical tests",
            "type": {
                "param_type": "ToolFloatRangeParam",
                "default": -1,
                "max": 0
            },
            "group": "Statistical Window"
        },
        {
            "key": "statistical_window_pre_end",
            "name": "Statistical window (pre, end)",
            "required": true,
            "description": "End of time window in seconds before each event to use for statistical tests",
            "type": {
                "param_type": "ToolFloatRangeParam",
                "default": 0,
                "max": 0
            },
            "group": "Statistical Window"
        },
        {
            "key": "statistical_window_post_start",
            "name": "Statistical window (post, start)",
            "required": true,
            "description": "Start of time window in seconds after each event to use for statistical tests",
            "type": {
                "param_type": "ToolFloatRangeParam",
                "default": 0,
                "min": 0
            },
            "group": "Statistical Window"
        },
        {
            "key": "statistical_window_post_end",
            "name": "Statistical window (post, end)",
            "required": true,
            "description": "End of time window in seconds after each event to use for statistical tests",
            "type": {
                "param_type": "ToolFloatRangeParam",
                "default": 1,
                "min": 0
            },
            "group": "Statistical Window"
        },
        {
            "key": "num_shuffles",
            "name": "Number of random shuffles",
            "required": true,
            "description": "Number of random shuffles of event times to perform for constructing null distribution",
            "type": {
                "param_type": "ToolIntRangeParam",
                "default": 1000,
                "min": 1
            }
        },
        {
            "key": "significance_threshold",
            "name": "Significance threshold",
            "required": true,
            "description": "p-value threshold for classifying neurons as up- or down-modulated",
            "type": {
                "param_type": "ToolFloatRangeParam",
                "default": 0.05,
                "min": 0,
                "max": 1
            }
        },
        {
            "key": "seed",
            "name": "Seed",
            "required": true,
            "description": "Seed for the random generator used to shuffle event indices",
            "type": {
                "param_type": "ToolIntRangeParam",
                "default": 0,
                "min": 0,
                "max": 4294967295
            }
        },
        {
            "key": "modulation_colors",
            "name": "Modulation colors",
            "required": false,
            "description": "Colors that represent up-, down- and non-modulation respectively",
            "type": {
                "param_type": "ToolStringParam",
                "default": "green,blue,black"
            },
            "group": "Visualization Parameters"
        },
        {
            "key": "single_group_color",
            "name": "Neural activity trace color",
            "required": false,
            "description": "The mean and sem trace color for event-aligned population activity",
            "type": {
                "param_type": "ToolStringParam",
                "default": "#1f77b4"
            },
            "group": "Visualization Parameters"
        },
        {
            "key": "cmap",
            "name": "Activity heatmap colormap",
            "required": false,
            "description": "Colormap applied to the activity heatmap",
            "type": {
                "param_type": "ToolStringParam",
                "default": "coolwarm"
            },
            "group": "Visualization Parameters"
        },
        {
            "key": "temporal_downsampling_factor",
            "name": "Temporal downsampling factor",
            "required": true,
            "description": "Temporal downsampling factor to apply to the activity traces before running the peri-event analysis",
            "type": {
                "param_type": "ToolIntRangeParam",
                "default": 1,
                "min": 1
            }
        },
        {
            "key": "population_activity_plot_limits",
            "name": "Population activity (y-axis range)",
            "required": false,
            "description": "y-axis range (z-score) applied to the event-aligned population activity plot specified as 'min,max' (e.g. -1,1) or 'auto'",
            "type": {
                "param_type": "ToolStringParam",
                "default": "auto"
            },
            "group": "Visualization Parameters"
        },
        {
            "key": "activity_heatmap_color_limits",
            "name": "Activity heatmap (colormap range)",
            "required": false,
            "description": "Colormap range (z-score) applied to the activity heatmap specified as 'min,max' (e.g. -1,1) or 'auto'",
            "type": {
                "param_type": "ToolStringParam",
                "default": "auto"
            },
            "group": "Visualization Parameters"
        },
        {
            "key": "activity_by_modulation_plot_limits",
            "name": "Activity by modulation group (y-axis range)",
            "required": false,
            "description": "y-axis range (z-score) applied to the event-aligned activity by modulation plot specified as 'min,max' (e.g. -1,1) or 'auto'",
            "type": {
                "param_type": "ToolStringParam",
                "default": "auto"
            },
            "group": "Visualization Parameters"
        },
        {
            "key": "output_dir",
            "name": "output_dir",
            "required": false,
            "description": "output_dir",
            "type": {
                "param_type": "ToolStringParam"
            }
        }
    ],
    "results": [
        {
            "key": "tool_output_group",
            "name": "Tool Outputs",
            "description": "Tool outputs",
            "file_patterns": [
                "**/*"
            ]
        }
    ],
    "resources": {
        "cpu": 4,
        "gpu": 0,
        "memory": 16000
    },
    "visibility": "public"
}